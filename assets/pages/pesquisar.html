<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CONTROLE SUPPORT TI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/moblie.css">
    <style>
        body {
            overflow: hidden;
            /* Desabilita o scroll do corpo */
        }

        .cabecalho {
            height: auto;
            /* Ajusta a altura automaticamente conforme o conteúdo */
        }

        .dados {
            overflow-y: scroll;
            /* Habilita o scroll apenas na sessão "dados" */
            overflow-x: hidden;
            /* Habilita o scroll apenas na sessão "dados" */
            height: calc(100vh - 220px);
            /* Calcula a altura dinamicamente */
        }
        .table-scroll {
        max-height: 700px; /* Altura máxima da tabela */
        overflow-y: auto; /* Adiciona uma barra de rolagem vertical quando necessário */
    }

    .thead-fixed th {
        position: sticky;
        top: 0;
        background-color: #f8f9fa; /* Cor de fundo do cabeçalho fixo */
        z-index: 1;
    }

    .positiondados{
            width: 95%;
            margin: 0 auto;
         
        }
    </style>
</head>



<body>
    <section class="container-custom">


        <section class="cabecalho">
          
            <div class="mt-5"></div>
            <div class="d-flex flex-column flex-md-row justify-content-md-between align-items-center">
                <p class="text-header">Pesquisar</p>
                <div class="d-flex flex-column flex-md-row w-50" style="margin-top: -10px;">
                    <div class="container">
                      <div class="row">
                        <div class="col">
                            <input id="pesquisarNome" class="form-control form-control-lg" placeholder="Pesquisar por categoria..." style="font-size: 14px;">
                        </div>
                        <div class="col">
                            <input id="pesquisarCodigoBarras" class="form-control form-control-lg" placeholder="Pesquisar por código de barras..." style="font-size: 14px;">
                        </div>
                      
                      </div>
                    </div>
                  </div>
                
            </div>
            <hr class="line">
    </section>

    <section class="dados">
        <div class="mt-2"></div>
        <div class="positiondados">
        <h1 class="mt-4">Itens Adicionados</h1>
        <br>
        <div class="table-scroll">
            <table class="table table-striped table-hover">
                <thead class="thead-fixed">
                    <tr>
                        <th scope="col">Nome</th>
                        <th scope="col">Código de Barras</th>
                        <th scope="col">Marca</th>
                        <th scope="col">Modelo</th>
                        <th scope="col">Opções</th>
                    </tr>
                </thead>
                <tbody id="tabelaItens">
                    <!-- Os dados serão preenchidos aqui -->
                </tbody>
            </table>
        </div>
       

    </div>
    </section>
    
        <div class="mt-4"></div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
        <script src="/assets/js/adicionar.js"></script>


    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var dadosSection = document.querySelector('.dados');
    
            // Impede a propagação do evento de rolagem para fora da sessão "dados"
            dadosSection.addEventListener('wheel', function (e) {
                e.stopPropagation();
            });
        });
    
        // Função para carregar os dados dos itens via AJAX
        function carregarDadosItens() {
            fetch('/dadosItens')
              .then(response => response.json())
              .then(data => {
                    const tabelaItens = document.getElementById('tabelaItens');
                    tabelaItens.innerHTML = ''; // Limpa a tabela antes de adicionar os novos dados
                    data.forEach(item => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${item.nome}</td>
                            <td>${item.codigo_de_barras}</td>
                            <td>${item.marca}</td>
                            <td>${item.modelo}</td>
                            <td>
                                <button class="btn btn-primary btn-sm">Editar</button>
                                <button class="btn btn-warning btn-sm">Baixa</button>
                                <button class="btn btn-danger btn-sm">Excluir</button>
                            </td>
                        `;
                        tabelaItens.appendChild(row);
                    });
                })
              .catch(error => console.error('Erro ao carregar dados dos itens:', error));
        }
    
        // Função para pesquisar itens pelo nome e/ou código de barras
        function pesquisarItens() {
            const nome = document.getElementById('pesquisarNome').value;
            const codigoBarras = document.getElementById('pesquisarCodigoBarras').value;
    
            // Fazer uma solicitação AJAX para pesquisar itens com base nos critérios fornecidos
            fetch(`/pesquisarItens?nome=${nome}&codigoBarras=${codigoBarras}`)
              .then(response => {
                    if (!response.ok) {
                        throw new Error('Erro ao pesquisar itens: ' + response.statusText);
                    }
                    return response.json();
                })
              .then(data => {
                    const tabelaItens = document.getElementById('tabelaItens');
                    tabelaItens.innerHTML = ''; // Limpa a tabela antes de adicionar os novos dados
                    data.forEach(item => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${item.nome}</td>
                            <td>${item.codigo_de_barras}</td>
                            <td>${item.marca}</td>
                            <td>${item.modelo}</td>
                            <td>
                                <button class="btn btn-primary btn-sm">Editar</button>
                                <button class="btn btn-warning btn-sm">Baixa</button>
                                <button class="btn btn-danger btn-sm">Excluir</button>
                            </td>
                        `;
                        tabelaItens.appendChild(row);
                    });
                })
              .catch(error => console.error(error));
        }
    
        // Chama a função para carregar os dados dos itens ao carregar a página
        carregarDadosItens();
    
        // Adicione um evento de escuta aos campos de entrada para chamar a função de pesquisa quando o usuário digitar
        document.getElementById('pesquisarNome').addEventListener('input', pesquisarItens);
        document.getElementById('pesquisarCodigoBarras').addEventListener('input', pesquisarItens);
    
        // Chama a função de pesquisa inicialmente
        pesquisarItens();
    </script>
    
    
    


</body>

</html>
